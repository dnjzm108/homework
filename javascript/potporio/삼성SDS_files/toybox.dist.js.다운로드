/*! livere.passport 2019-03-27 */
var Toybox=function(){"use strict";function serial(a){return a+"-"+Math.floor(1e3*Math.random())}function addEventListener(a,b){return window.addEventListener?window.addEventListener(a,b):window.attachEvent("on"+a,b)}function removeEventListener(a,b){return window.removeEventListener?window.removeEventListener(a,b):window.detachEvent("on"+a,b)}function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function postMessage(a,b){if(a&&b&&!isRestrictIEVersion(7))return a.postMessage(JSON.stringify(b),"*")}function animateScroll(a,b){function c(a){return a>=offset()}function d(a){return a<=offset()}function e(){return clearInterval(get("timer"))}set("timer",setInterval(function(){return(b?c(a):d(a))?(clearInterval(get("timer")),set("timer",null)):(setTimeout(e,1e3),window.scrollTo(0,b?offset()-100:offset()+100))},1))}function isRestrictIEVersion(a){if(a){var b=(get("browser")?get("browser"):setBrowser()).split(" ")[0],c=Number(get("browser").split(" ")[1]);return"MSIE"===b&&!(c&&c>a)}}function setBrowser(){return set("browser",function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],"IE "+(a[1]||"")):"Chrome"===c[1]&&null!=(a=b.match(/\bOPR\/(\d+)/))?"Opera "+a[1]:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),c.join(" "))}())}function isObjectPropertiesNull(a){for(var b in a)if("string"!=typeof b||!a[b]&&0!==a[b])return!0;return!1}function hasProtocol(a){return new RegExp("^(http|https)://","i").test(a)}function search(a,b,c){return a<1?c:"object"==typeof c?search(a-1,b,c[b[b.length-a]]):void 0}function get(a){var b=variables[a],a=a.split(".");return"object"==typeof a&&a.length>1&&(b=search(a.length,a,variables)),b}function set(a,b){if("object"!=typeof a||b)return variables[a]=b,get(a);for(var c in a)variables[c]=a[c]}function warning(a){console.log(["WARN: ",a].join(""))}function error(a){throw["ERROR: ",a].join("")}function template(a,b){return get("config.target").indexOf(a)<0?void console.log("Target not found."):function(a,b){a="cidget"===a?"cidget":a;var c=document.createElement("iframe"),d=get("config.baseURI")+a;return c.title="livere share widget",c.scrolling="no",c.async=!0,c.frameBorder=0,c.allowTransparency="true",c.src=concatURI(d,b,!0),isRestrictIEVersion(7)&&(c.scrolling="auto",c.height="500px"),c}(a,b)}function concatURI(a,b,c){var d="?";for(var e in b)d+=b[e]?e+"="+encodeURIComponent(b[e])+"&":"";return a+d+(c?"":"callback=?")}function offset(){return window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop}var toybox={},config={},variables={config:{baseURI:"https://passport.livere.com/",target:["widget","cidget"]}};return toybox.__version__="0.1a",toybox.init=function(){return window.livereWidgetOptions&&window.livereWidgetOptions.lazy?void(window.livereWidgetOptions.lazy=!1):isRestrictIEVersion(9)?config.previousVersion.call(this):toybox.start.call(this)},toybox.reloadTo=function(a){if(a)return set("renderTarget",a),toybox.close(),toybox.start.call(this,get("options.target"))},toybox.start=function(a){toybox.watch.call(this),set("renderTarget",get("renderTarget")||"#lv-widget"),set({common:config.parse(),options:window.livereWidgetOptions||{}});var a=get("options.target")||"widget";return toybox.load.call(this,a)},toybox.refresh=function(){var a=get("widget");if(a)return postMessage(a.contentWindow,{e:"refresh"})},toybox.close=function(){get("widget")&&get("widget").remove(),set({loaded:!1,widget:null})},toybox.watch=function(){var a={loaded:function(){set("loaded",!0),toybox.updateParams()},resize:function(a){return!a.height||(get("widget").style.height=a.height+"px")},close:function(){return toybox.close.call(this)},refreshAll:function(){return!window.LivereTower||window.LivereTower.refresh()},openWechat:function(a){toybox.drawWechat(a.url,a.isMobile)}};return addEventListener("message",function(b){if(b.data&&"string"==typeof b.data&&b.data.match(/^{.*}$/g)){var c=JSON.parse(b.data);if("widget"===c.caller)return!!a[c.e]&&a[c.e](c.params)}})},toybox.load=function(a){var b=get("common");a&&b&&(b.titleLength=b.title.length,b.title=encodeURIComponent(escape(b.title)),toybox.draw.call(this,a,template(a,b)))},toybox.updateParams=function(){var a=document.querySelector('meta[property="og:description"]');if(a&&a.content)return postMessage(get("widget").contentWindow,{e:"updateParams",params:{description:a.content}})},toybox.draw=function(a,b){function c(a){return set("widget",document.getElementById(a))}var d=window.livereWidgetOptions||{},e="overflow:hidden;border:0;z-index:14761;";if(e=e+"width:"+(d.width?d.width+";":"auto;")+"height:"+(d.height?d.height+";":"50px;")+("cidget"===a?"min-width:100px;":"min-width:306px;max-width:500px;"),b){var f=serial("widget");return b.style.cssText=e,b.id=f,document.querySelector(get("renderTarget")).appendChild(b),c(f)}},toybox.drawWechat=function(a,b){function c(){new QRCode(h.querySelector(".wechat-share-qrcode"),{text:a,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}function d(a){a.stopPropagation(),j.removeEventListener("click",d),j.addEventListener("click",e),j.classList.add("wechat-share-show-how-to-button--open"),i.style.display="block"}function e(a){a.stopPropagation(),j.removeEventListener("click",e),j.addEventListener("click",d),j.classList.remove("wechat-share-show-how-to-button--open"),i.style.display=""}if(b)return void alert("注意! 手机端暂时不支持微信分享功能");if(!get("wechatDom")){var f=document.createElement("div");f.id="wechat-share-wrapper",f.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.3);";var g=document.createElement("style");g.innerHTML="#wechat-share-wrapper * { margin: 0; padding: 0; line-height: 1.4; font-size: 14px; color: black; list-style: none; } #wechat-share-wrapper .wechat-share { position: relative; top: 50%; left: 50%; transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); max-width: 500px; width: calc(100% - 20px); border: 1px solid gray; background: white; border-radius: 5px; box-sizing: border-box; padding: 30px 40px; } #wechat-share-wrapper .wechat-share-close-button { position: absolute; top: 30px; right: 40px; width: 26px; height: 26px; box-sizing: border-box; border: 0; background: 0; background-image: url(https://cdn-city.livere.com/images/wechat-share-guide/close.png); background-size: 26px 26px; background-repeat: no-repeat; } #wechat-share-wrapper h1 { font-size: 20px; } #wechat-share-wrapper .wechat-share-qrcode { margin: 30px auto; width: 128px; } #wechat-share-wrapper hr { margin: 18px 0; } #wechat-share-wrapper .wechat-share-show-how-to-button { float: right; position: relative; top: -30px; padding: 3px; padding-right: 25px; border: 0; background: 0; background-image: url(https://cdn-city.livere.com/images/wechat-share-guide/drop.png); background-size: 26px 26px; background-repeat: no-repeat; background-position: 100% 0; } #wechat-share-wrapper .wechat-share-show-how-to-button.wechat-share-show-how-to-button--open { background-image: url(https://cdn-city.livere.com/images/wechat-share-guide/up.png); } #wechat-share-wrapper .wechat-share-how-to { display: none; clear: both; } #wechat-share-wrapper .wechat-share-how-to li { display: inline-block; width: 33.3%; box-sizing: border-box; padding: 2px; vertical-align: top; } #wechat-share-wrapper .wechat-share-how-to img { max-width: 100%; }",f.appendChild(g);var h=document.createElement("div");h.classList.add("wechat-share"),h.innerHTML='<button class="wechat-share-close-button"></button><h1>分享到微信</h1><p>用微信“扫一扫”二维码，即可把链接分享给您的微信朋友或朋友圈</p><div class="wechat-share-qrcode"></div><hr><h1>如何分享?</h1><button class="wechat-share-show-how-to-button">详细说明</button><div class="wechat-share-how-to"><ol><li><img src="https://cdn-city.livere.com/images/wechat-share-guide/guide1.png"> <p>1. 点击右上角“+”按钮，选择“扫一扫”，并用镜头对准二维码</p></li><li><img src="https://cdn-city.livere.com/images/wechat-share-guide/guide2.png"> <p>2. 扫描成功后，点击右上角按钮</p></li><li><img src="https://cdn-city.livere.com/images/wechat-share-guide/guide3.png"> <p>3. 选择“发送给朋友”，或者“分享到朋友圈”</p></li></ol></div>';var i=h.querySelector(".wechat-share-how-to"),j=h.querySelector(".wechat-share-show-how-to-button");if(j.addEventListener("click",d),f.appendChild(h),set("wechatDom",f),f.addEventListener("click",toybox.removeWechat),document.body.appendChild(f),!window.QRCode){var k=document.createElement("script");k.onload=c,k.src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js";return void document.querySelector("head").appendChild(k)}c()}},toybox.removeWechat=function(){var a=get("wechatDom");a&&(document.body.removeChild(a),set("wechatDom",null))},config.previousVersion=function(){return Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1}),function(){var a=document.createStyleSheet(),b=function(b,c){var d,e=document.all,f=e.length,g=[];for(a.addRule(b,"foo:bar"),d=0;d<f&&!("bar"===e[d].currentStyle.foo&&(g.push(e[d]),g.length>c));d+=1);return a.removeRule(0),g};document.querySelectorAll||document.querySelector||(document.querySelectorAll=function(a){return b(a,1/0)},document.querySelector=function(a){return b(a,1)[0]||null})}(),"object"!=typeof JSON&&(JSON={}),function(){function f(a){return a<10?"0"+a:a}function this_value(){return this.valueOf()}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"==typeof rep[c]&&(d=rep[c],(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e);return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),toybox.start.call(this)},config.parse=function(){var a=document,b=a.querySelector(get("renderTarget"));if(!b)return!1;var c=b.getAttribute("data-image")||a.querySelector('meta[property="og:image"]'),d=b.getAttribute("data-title")||a.querySelector('meta[property="og:title"]'),e=b.getAttribute("data-url")||a.querySelector('meta[property="og:url"]'),f=window.livereWidgetOptions||{},g={id:b.getAttribute("data-id"),list:f.list||null,width:f.width||"auto",refer:f.refer||window.refer||location.host+location.pathname,size:f.size||48,align:f.align||"center",innerWidth:f.innerWidth||"auto",facebookAppId:f.facebookAppId||"1694333994144156",kakaoAppKey:f.kakaoAppKey||"b9c064d59e9db14790b89f36137e7ccb"};return!isObjectPropertiesNull(g)&&(g.uid=b.getAttribute("data-uid")||null,g.site="string"==typeof e?e:e?e.getAttribute("content"):location.href,g.title="string"==typeof d?d:(d?d.getAttribute("content"):document.title)||"Welcome to the black parade",g.logo="string"==typeof c?c:c?c.getAttribute("content"):null,g.customStyle=f.customStyle,g.customCss=f.customCss,g.webview=f.webview,g)},toybox.get=get,toybox.set=set,{init:toybox.init,refresh:toybox.refresh,close:toybox.close,reloadTo:toybox.reloadTo,get:get}}();Toybox.init();